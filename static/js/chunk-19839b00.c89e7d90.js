(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19839b00"],{"09ef":function(e,t,n){},2995:function(e,t,n){"use strict";n("a39b")},"722f":function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}]')},"76a7":function(e,t,n){"use strict";n.r(t);n("a9e3");var a=n("7a23"),r=n("8d5e"),i=n.n(r),s=n("c2a5"),o=n.n(s),u=n("ab9f"),c=n.n(u),p=function(e){return Object(a["H"])("data-v-deba3f88"),e=e(),Object(a["F"])(),e},l={class:"swap-box invest-box"},d={class:"img-box"},b={key:0,src:i.a,alt:""},y={key:1,src:o.a,alt:""},m={class:"input-box"},f=p((function(){return Object(a["k"])("span",{class:"sympol"},"KTT",-1)})),w={class:"btn-box"},g=Object(a["m"])("合成"),j=Object(a["m"])("授权"),O=p((function(){return Object(a["k"])("img",{class:"show-img",src:c.a},null,-1)}));function v(e,t,n,r,i,s){var o=Object(a["L"])("HeadTop"),u=Object(a["L"])("van-field"),c=Object(a["L"])("van-button"),p=Object(a["L"])("van-dialog");return Object(a["E"])(),Object(a["j"])(a["a"],null,[Object(a["k"])("div",l,[Object(a["n"])(o,{title:"合成",isShowTop:!0,isSubHeader:!1}),Object(a["k"])("div",d,[!e.btn.loading||Number(e.kttAllowance)<=0?(Object(a["E"])(),Object(a["j"])("img",b)):Number(e.kttAllowance)>0&&e.btn.loading?(Object(a["E"])(),Object(a["j"])("img",y)):Object(a["i"])("",!0)]),Object(a["k"])("div",m,[Object(a["n"])(u,{class:"cell-input",modelValue:e.amount,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.amount=t}),type:"number",center:"",label:"",placeholder:"请输入投资数量"},{extra:Object(a["V"])((function(){return[f]})),_:1},8,["modelValue"])]),Object(a["k"])("div",w,[Number(e.kttAllowance)>0?(Object(a["E"])(),Object(a["h"])(c,{key:0,color:"linear-gradient(270deg, #00DFB2 0%, #00C4DE 100%)",type:"primary",size:"large",loading:e.btn.loading,"loading-text":"正在合成...",block:"",onClick:e.mergeNft},{default:Object(a["V"])((function(){return[g]})),_:1},8,["loading","onClick"])):(Object(a["E"])(),Object(a["h"])(c,{key:1,color:"linear-gradient(270deg, #00DFB2 0%, #00C4DE 100%)",type:"primary",size:"large",loading:e.btn.loading,"loading-text":"正在授权...",block:"",onClick:e.approveKtt},{default:Object(a["V"])((function(){return[j]})),_:1},8,["loading","onClick"]))])]),Object(a["n"])(p,{show:e.show,"onUpdate:show":t[1]||(t[1]=function(t){return e.show=t}),title:""},{default:Object(a["V"])((function(){return[O]})),_:1},8,["show"])],64)}var T=n("5530"),k=n("1da1"),x=(n("b680"),n("96cf"),n("1a2e")),h=n("5502"),C=n("a1be"),A=n("722f"),M=n("626a"),N=n("01ea"),K=n("9d56"),V=n("c00b"),_=n("901e"),E=n.n(_),D=n("98b3"),R={components:{HeadTop:x["a"]},setup:function(){var e=Object(h["b"])(),t=Object(a["I"])({address:Object(a["f"])((function(){return e.state.accounts[0]})),web3:Object(a["f"])((function(){return e.state.provider})),swapContract:null,voiceNftContract:null,intro:D["a"].get()||N["a"].rootAddress,show:!1,amount:"",kttAllowance:"",btn:{loading:!1},initContract:function(){t.swapContract=new t.web3.eth.Contract(C,N["a"].swapAddress),t.kttContract=new t.web3.eth.Contract(A,N["a"].kttAddress),t.initData()},initData:function(){t.getKttAllowance()},getKttAllowance:function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.kttContract.methods.allowance(t.address,N["a"].swapAddress).call();case 2:n=e.sent,t.kttAllowance=n;case 4:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),approveKtt:function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.btn.swaploading=!0,e.prev=1,e.next=4,t.kttContract.methods.approve(N["a"].swapAddress,K["b"]).send({from:t.address});case 4:Object(M["a"])("授权成功"),t.getKttAllowance(),t.btn.swaploading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),Object(M["a"])("授权失败"),t.btn.swaploading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));function n(){return e.apply(this,arguments)}return n}(),mergeNft:function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.kttContract.methods.balanceOf(t.address).call();case 2:return n=e.sent,e.next=5,t.swapContract.methods.minInvestAmount().call();case 5:return a=e.sent,e.next=9,t.kttContract.methods.decimals().call();case 9:if(r=e.sent,i=new E.a(t.amount).multipliedBy(Math.pow(10,r)).toFixed(),t.amount){e.next=14;break}return Object(M["a"])("请输入投资数量"),e.abrupt("return");case 14:if(!(Number(i)<Number(a))){e.next=17;break}return Object(M["a"])("KTT投资数量最小500KTT"),e.abrupt("return");case 17:if(!(Number(n)<Number(i))){e.next=20;break}return Object(M["a"])("KTT余额不足"),e.abrupt("return");case 20:return e.next=22,t.swapContract.methods.getUserInfo(t.intro).call();case 22:return s=e.sent,e.next=25,t.swapContract.methods.getUserInfo(t.address).call();case 25:if(o=e.sent,s.intro!=V["a"]||t.intro==N["a"].rootAddress||o.intro!=V["a"]){e.next=29;break}return Object(M["a"])("推荐人无效"),e.abrupt("return");case 29:return t.btn.loading=!0,e.prev=30,e.next=33,t.swapContract.methods.invest(i,t.intro).send({from:t.address});case 33:Object(M["a"])("合成成功"),t.show=!0,t.btn.loading=!1,e.next=43;break;case 38:e.prev=38,e.t0=e["catch"](30),Object(M["a"])("合成失败"),t.btn.loading=!1;case 43:case"end":return e.stop()}}),e,null,[[30,38]])})));function n(){return e.apply(this,arguments)}return n}()});t.address&&t.initContract(),Object(a["T"])((function(){return t.address}),(function(e){e&&t.initContract()}));var n=Object(a["Q"])(t);return Object(T["a"])({},n)}},F=(n("2995"),n("dc53"),n("6b0d")),I=n.n(F);const H=I()(R,[["render",v],["__scopeId","data-v-deba3f88"]]);t["default"]=H},"8d5e":function(e,t,n){e.exports=n.p+"static/img/merge.47933a4b.png"},a39b:function(e,t,n){},ab9f:function(e,t,n){e.exports=n.p+"static/img/index_img.8839ad11.png"},c2a5:function(e,t,n){e.exports=n.p+"static/img/_4.e8519102.gif"},dc53:function(e,t,n){"use strict";n("09ef")}}]);
//# sourceMappingURL=chunk-19839b00.c89e7d90.js.map