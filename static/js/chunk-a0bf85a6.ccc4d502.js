(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a0bf85a6"],{2630:function(e,t,a){},"52f9":function(e,t,a){"use strict";a.r(t);var n=a("7a23"),c=function(e){return Object(n["H"])("data-v-16e4aec8"),e=e(),Object(n["F"])(),e},i={class:"swap-box invest-box"},r={class:"list-box"},s={class:"top flex-middle"},d={class:"top-item flex-item"},o={class:"num"},u=c((function(){return Object(n["k"])("div",{class:"desc"},"质押KTT",-1)})),l=c((function(){return Object(n["k"])("div",{class:"line"},null,-1)})),b={class:"top-item flex-item"},j={class:"num yellow"},m=c((function(){return Object(n["k"])("div",{class:"desc"},"KTM总收益",-1)})),O={class:"bottom"},f={key:0,class:"status"},k={key:1,class:"status"},p={key:2,class:"status red"},v={class:"row flex-middle"},w=c((function(){return Object(n["k"])("div",{class:"name"},"时长",-1)})),h={class:"value"},y={class:"row flex-middle"},x=c((function(){return Object(n["k"])("div",{class:"name"},"质押时间",-1)})),T={class:"value"},g={class:"row flex-middle"},C=c((function(){return Object(n["k"])("div",{class:"name"},"质押到期时间",-1)})),R={class:"value"},K={key:0,class:"btn-box flex-between"},L=c((function(){return Object(n["k"])("span",null,null,-1)})),M=Object(n["m"])("领取");function E(e,t,a,c,E,H){var B=Object(n["L"])("HeadTop"),N=Object(n["L"])("van-button"),P=Object(n["L"])("van-list");return Object(n["E"])(),Object(n["j"])("div",i,[Object(n["n"])(B,{title:"记录",isShowTop:!0,isSubHeader:!1}),Object(n["n"])(P,{loading:e.loading,"onUpdate:loading":t[0]||(t[0]=function(t){return e.loading=t}),"immediate-check":!1,error:e.error,"onUpdate:error":t[1]||(t[1]=function(t){return e.error=t}),"error-text":"请求失败，点击重新加载",finished:e.finished,"finished-text":"没有更多了",onLoad:e.onLoad},{default:Object(n["V"])((function(){return[Object(n["k"])("div",r,[(Object(n["E"])(!0),Object(n["j"])(n["a"],null,Object(n["K"])(e.list,(function(t,a){return Object(n["E"])(),Object(n["j"])("div",{class:"item",key:a},[Object(n["k"])("div",s,[Object(n["k"])("div",d,[Object(n["k"])("div",o,Object(n["P"])(t.stakeKttAmount),1),u]),l,Object(n["k"])("div",b,[Object(n["k"])("div",j,Object(n["P"])(t.totalRewardKtm),1),m])]),Object(n["k"])("div",O,[t.isValid?t.isCanTake?(Object(n["E"])(),Object(n["j"])("div",k,"可领取")):(Object(n["E"])(),Object(n["j"])("div",p,Object(n["P"])(e.$t("未到期")),1)):(Object(n["E"])(),Object(n["j"])("div",f,"已领取")),Object(n["k"])("div",v,[w,Object(n["k"])("div",h,Object(n["P"])(t.lockTime)+"天",1)]),Object(n["k"])("div",y,[x,Object(n["k"])("div",T,Object(n["P"])(t.stakeTime),1)]),Object(n["k"])("div",g,[C,Object(n["k"])("div",R,Object(n["P"])(t.endTime),1)])]),t.isCanTake&&t.isValid?(Object(n["E"])(),Object(n["j"])("div",K,[L,Object(n["n"])(N,{type:"primary",class:"btn-green",style:{width:"120px"},block:"",onClick:function(a){return e.withdrawRewardStakeRecord(t.id)}},{default:Object(n["V"])((function(){return[M]})),_:2},1032,["onClick"])])):Object(n["i"])("",!0)])})),128))])]})),_:1},8,["loading","error","finished","onLoad"])])}var H=a("5530"),B=a("1da1"),N=(a("96cf"),a("d3b7"),a("159b"),a("a9e3"),a("b680"),a("1a2e")),P=a("5502"),V=a("a1be"),F=a("626a"),S=a("01ea"),A=a("901e"),_=a.n(A),U=a("b9b9"),D=a.n(U),I={components:{HeadTop:N["a"]},setup:function(){var e=Object(P["b"])(),t=Object(n["I"])({address:Object(n["f"])((function(){return e.state.accounts[0]})),web3:Object(n["f"])((function(){return e.state.provider})),swapContract:null,page:1,limit:5,loading:!1,error:!1,finished:!1,list:[],initContract:function(){t.swapContract=new t.web3.eth.Contract(V,S["a"].swapAddress),t.initData()},initData:function(){t.list=[],t.page=1,t.getList()},onLoad:function(){t.page++,t.getList()},getList:function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(){var a,n,c,i,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.swapContract.methods.getUserRewardRecords(t.address,1,5).call({from:t.address});case 2:return a=e.sent,e.next=5,t.swapContract.methods.periodTime().call();case 5:return n=e.sent,e.next=8,t.swapContract.methods.getBlockTimestamp().call();case 8:c=e.sent,i=a.records,r=[],i.forEach((function(e){Number(e.id)>0&&r.push({stakeKttAmount:new _.a(e.stakeKttAmount).dividedBy(Math.pow(10,18)).toFixed(2),totalRewardKtm:new _.a(e.totalRewardKtm).dividedBy(Math.pow(10,18)).toFixed(2),dayBackKtm:new _.a(e.dayBackKtm).dividedBy(Math.pow(10,18)).toFixed(2),id:e.id,isValid:e.isValid,lockTime:new _.a(e.lockTime).dividedBy(n).toFixed(1),stakeTime:D()(1e3*e.stakeTime,"yyyy-mm-dd HH:MM:ss"),endTime:D()(1e3*(Number(e.stakeTime)+Number(e.lockTime)),"yyyy-mm-dd HH:MM:ss"),isCanTake:Number(c)>=Number(e.stakeTime)+Number(e.lockTime)})})),1===t.page?t.list=r:(s=t.list).push.apply(s,r),t.loading=!1,t.finished=!(Math.ceil(a.total/t.limit)>t.page);case 15:case"end":return e.stop()}}),e)})));function a(){return e.apply(this,arguments)}return a}(),withdrawRewardStakeRecord:function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.swapContract.methods.withdrawRewardStakeRecord(a).send({from:t.address});case 3:Object(F["a"])("领取成功"),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),Object(F["a"])("领取失败");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));function a(t){return e.apply(this,arguments)}return a}()});t.address&&t.initContract(),Object(n["T"])((function(){return t.address}),(function(e){e&&t.initContract()}));var a=Object(n["Q"])(t);return Object(H["a"])({},a)}},J=(a("5baa"),a("6b0d")),Q=a.n(J);const $=Q()(I,[["render",E],["__scopeId","data-v-16e4aec8"]]);t["default"]=$},"5baa":function(e,t,a){"use strict";a("2630")}}]);
//# sourceMappingURL=chunk-a0bf85a6.ccc4d502.js.map