(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11752098"],{"0d57":function(e,t,n){"use strict";n("d4e0")},6095:function(e,t,n){"use strict";n.r(t);var a=n("7a23"),c=function(e){return Object(a["H"])("data-v-7fd18c30"),e=e(),Object(a["F"])(),e},i={class:"swap-box invest-box"},r={class:"list-box"},d={class:"top flex-middle"},s={class:"top-item flex-item"},o={class:"num"},l=c((function(){return Object(a["k"])("div",{class:"desc"},"质押KTT",-1)})),u=c((function(){return Object(a["k"])("div",{class:"line"},null,-1)})),b={class:"top-item flex-item"},m={class:"num yellow"},j=c((function(){return Object(a["k"])("div",{class:"desc"},"KTM总收益",-1)})),v={class:"bottom"},O={class:"row flex-middle"},p=c((function(){return Object(a["k"])("div",{class:"name"},"时长",-1)})),f={class:"value"},k={class:"row flex-middle"},w=c((function(){return Object(a["k"])("div",{class:"name"},"倍数",-1)})),h={class:"value"},x={class:"row flex-middle"},y=c((function(){return Object(a["k"])("div",{class:"name"},"已领取",-1)})),g={class:"value"},T={class:"row flex-middle"},B=c((function(){return Object(a["k"])("div",{class:"name"},"待领取",-1)})),K={class:"value"},M={class:"row flex-middle"},R=c((function(){return Object(a["k"])("div",{class:"name"},"质押时间",-1)})),C={class:"value"},L={class:"row flex-middle"},F=c((function(){return Object(a["k"])("div",{class:"name"},"质押到期时间",-1)})),H={class:"value"},P={class:"btn-box flex-between"},A=c((function(){return Object(a["k"])("span",null,null,-1)})),N=Object(a["m"])("领取");function S(e,t,n,c,S,E){var I=Object(a["L"])("HeadTop"),_=Object(a["L"])("van-button"),U=Object(a["L"])("van-list");return Object(a["E"])(),Object(a["j"])("div",i,[Object(a["n"])(I,{title:"质押记录",isShowTop:!0,isSubHeader:!1}),Object(a["n"])(U,{loading:e.loading,"onUpdate:loading":t[0]||(t[0]=function(t){return e.loading=t}),"immediate-check":!1,error:e.error,"onUpdate:error":t[1]||(t[1]=function(t){return e.error=t}),"error-text":"请求失败，点击重新加载",finished:e.finished,"finished-text":"没有更多了",onLoad:e.onLoad},{default:Object(a["V"])((function(){return[Object(a["k"])("div",r,[(Object(a["E"])(!0),Object(a["j"])(a["a"],null,Object(a["K"])(e.list,(function(t,n){return Object(a["E"])(),Object(a["j"])("div",{class:"item",key:n},[Object(a["k"])("div",d,[Object(a["k"])("div",s,[Object(a["k"])("div",o,Object(a["P"])(t.stakeKttAmount),1),l]),u,Object(a["k"])("div",b,[Object(a["k"])("div",m,Object(a["P"])(t.totalRewardKtm),1),j])]),Object(a["k"])("div",v,[Object(a["k"])("div",O,[p,Object(a["k"])("div",f,Object(a["P"])(t.lockTime)+"天",1)]),Object(a["k"])("div",k,[w,Object(a["k"])("div",h,Object(a["P"])(t.rate),1)]),Object(a["k"])("div",x,[y,Object(a["k"])("div",g,Object(a["P"])(t.haveBack)+"KTM",1)]),Object(a["k"])("div",T,[B,Object(a["k"])("div",K,Object(a["P"])(t.canGetAmount)+"KTM",1)]),Object(a["k"])("div",M,[R,Object(a["k"])("div",C,Object(a["P"])(t.stakeTime),1)]),Object(a["k"])("div",L,[F,Object(a["k"])("div",H,Object(a["P"])(t.endTime),1)])]),Object(a["k"])("div",P,[A,Object(a["n"])(_,{type:"primary",class:"btn-green",style:{width:"120px"},block:"",onClick:function(n){return e.withdrawRewardStakeRecord(t.id)}},{default:Object(a["V"])((function(){return[N]})),_:2},1032,["onClick"])])])})),128))])]})),_:1},8,["loading","error","finished","onLoad"])])}var E=n("5530"),I=n("1da1"),_=(n("96cf"),n("d3b7"),n("159b"),n("a9e3"),n("b680"),n("1a2e")),U=n("5502"),D=n("a1be"),G=n("626a"),J=n("01ea"),V=n("901e"),Q=n.n(V),q=n("b9b9"),z=n.n(q),W={components:{HeadTop:_["a"]},setup:function(){var e=Object(U["b"])(),t=Object(a["I"])({address:Object(a["f"])((function(){return e.state.accounts[0]})),web3:Object(a["f"])((function(){return e.state.provider})),swapContract:null,page:1,limit:5,loading:!1,error:!1,finished:!1,list:[],initContract:function(){t.swapContract=new t.web3.eth.Contract(D,J["a"].swapAddress),t.initData()},initData:function(){t.list=[],t.page=1,t.getList()},onLoad:function(){t.page++,t.getList()},getList:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(){var n,a,c,i,r,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.swapContract.methods.getUserRecords(t.address,1,5).call({from:t.address});case 2:return n=e.sent,e.next=5,t.swapContract.methods.periodTime().call();case 5:return a=e.sent,e.next=8,t.swapContract.methods.getBlockTimestamp().call();case 8:c=e.sent,i=n.records,r=[],i.forEach((function(e){Number(e.id)>0&&r.push({stakeKttAmount:new Q.a(e.stakeKttAmount).dividedBy(Math.pow(10,18)).toFixed(2),totalRewardKtm:new Q.a(e.totalRewardKtm).dividedBy(Math.pow(10,18)).toFixed(2),dayBackKtm:new Q.a(e.dayBackKtm).dividedBy(Math.pow(10,18)).toFixed(2),id:e.id,rate:e.rate/1e4,lockTime:new Q.a(e.period).dividedBy(a).toFixed(1),stakeTime:z()(1e3*e.stakeTime,"yyyy-mm-dd HH:MM:ss"),endTime:z()(1e3*(Number(e.stakeTime)+Number(e.period)),"yyyy-mm-dd HH:MM:ss"),haveBack:new Q.a(e.haveBack).dividedBy(Math.pow(10,18)).toFixed(2),canGetAmount:c>=Number(e.stakeTime)+Number(e.period)?new Q.a(parseInt(e.period/a)).multipliedBy(e.dayBackKtm).minus(e.haveBack).dividedBy(Math.pow(10,18)).toFixed(2):new Q.a(parseInt((c-e.stakeTime)/a)).multipliedBy(e.dayBackKtm).minus(e.haveBack).dividedBy(Math.pow(10,18)).toFixed(2)})})),1===t.page?t.list=r:(d=t.list).push.apply(d,r),t.loading=!1,t.finished=!(Math.ceil(n.total/t.limit)>t.page);case 16:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),withdrawRewardStakeRecord:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.swapContract.methods.withdrawStakeRecord(n).send({from:t.address});case 3:Object(G["a"])("领取成功"),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),Object(G["a"])("领取失败");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));function n(t){return e.apply(this,arguments)}return n}()});t.address&&t.initContract(),Object(a["T"])((function(){return t.address}),(function(e){e&&t.initContract()}));var n=Object(a["Q"])(t);return Object(E["a"])({},n)}},X=(n("0d57"),n("6b0d")),Y=n.n(X);const Z=Y()(W,[["render",S],["__scopeId","data-v-7fd18c30"]]);t["default"]=Z},d4e0:function(e,t,n){}}]);
//# sourceMappingURL=chunk-11752098.988a6339.js.map