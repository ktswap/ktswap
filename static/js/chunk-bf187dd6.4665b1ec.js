(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf187dd6"],{5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("e330"),r=n("1d80"),c=n("577e"),o=n("5899"),i=a("".replace),s="["+o+"]",u=RegExp("^"+s+s+"*"),b=RegExp(s+s+"*$"),l=function(t){return function(e){var n=c(r(e));return 1&t&&(n=i(n,u,"")),2&t&&(n=i(n,b,"")),n}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5aea":function(t,e,n){},"76a7":function(t,e,n){"use strict";n.r(e);n("a9e3");var a=n("7a23"),r=n("8d5e"),c=n.n(r),o=n("c2a5"),i=n.n(o),s=n("ab9f"),u=n.n(s),b=function(t){return Object(a["H"])("data-v-8ef34a16"),t=t(),Object(a["F"])(),t},l={class:"swap-box"},d={class:"img-box"},f={key:0,src:c.a,alt:""},p={key:1,src:i.a,alt:""},g={class:"btn-box"},w=Object(a["m"])("合成"),m=Object(a["m"])("授权"),j=b((function(){return Object(a["k"])("img",{class:"show-img",src:u.a},null,-1)}));function O(t,e,n,r,c,o){var i=Object(a["L"])("HeadTop"),s=Object(a["L"])("van-button"),u=Object(a["L"])("van-dialog");return Object(a["E"])(),Object(a["j"])(a["a"],null,[Object(a["k"])("div",l,[Object(a["n"])(i,{title:"合成",isShowTop:!0,isSubHeader:!1}),Object(a["k"])("div",d,[!t.btn.loading||Number(t.kttAllowance)<=0?(Object(a["E"])(),Object(a["j"])("img",f)):Number(t.kttAllowance)>0&&t.btn.loading?(Object(a["E"])(),Object(a["j"])("img",p)):Object(a["i"])("",!0)]),Object(a["k"])("div",g,[Number(t.kttAllowance)>0?(Object(a["E"])(),Object(a["h"])(s,{key:0,color:"linear-gradient(270deg, #00DFB2 0%, #00C4DE 100%)",type:"primary",size:"large",loading:t.btn.loading,"loading-text":"正在合成...",block:"",onClick:t.mergeNft},{default:Object(a["V"])((function(){return[w]})),_:1},8,["loading","onClick"])):(Object(a["E"])(),Object(a["h"])(s,{key:1,color:"linear-gradient(270deg, #00DFB2 0%, #00C4DE 100%)",type:"primary",size:"large",loading:t.btn.loading,"loading-text":"正在授权...",block:"",onClick:t.approveKtt},{default:Object(a["V"])((function(){return[m]})),_:1},8,["loading","onClick"]))])]),Object(a["n"])(u,{show:t.show,"onUpdate:show":e[0]||(e[0]=function(e){return t.show=e}),title:""},{default:Object(a["V"])((function(){return[j]})),_:1},8,["show"])],64)}var h=n("5530"),v=n("1da1"),k=(n("b680"),n("96cf"),n("1a2e")),N=n("5502"),x=n("a1be"),C=n("722f"),E=n("626a"),A=n("01ea"),I=n("9d56"),y=n("901e"),_=n.n(y),T={components:{HeadTop:k["a"]},setup:function(){var t=Object(N["b"])(),e=Object(a["I"])({address:Object(a["f"])((function(){return t.state.accounts[0]})),web3:Object(a["f"])((function(){return t.state.provider})),swapContract:null,voiceNftContract:null,show:!1,kttAllowance:"",btn:{loading:!1},initContract:function(){e.swapContract=new e.web3.eth.Contract(x,A["a"].swapAddress),e.kttContract=new e.web3.eth.Contract(C,A["a"].kttAddress),e.initData()},initData:function(){e.getKttAllowance()},getKttAllowance:function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.kttContract.methods.allowance(e.address,A["a"].swapAddress).call();case 2:n=t.sent,e.kttAllowance=n;case 4:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),approveKtt:function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.btn.swaploading=!0,t.prev=1,t.next=4,e.kttContract.methods.approve(A["a"].swapAddress,I["b"]).send({from:e.address});case 4:Object(E["a"])("授权成功"),e.getKttAllowance(),e.btn.swaploading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),Object(E["a"])("授权失败"),e.btn.swaploading=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));function n(){return t.apply(this,arguments)}return n}(),mergeNft:function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(){var n,a,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.kttContract.methods.balanceOf(e.address).call();case 2:return n=t.sent,t.next=5,e.swapContract.methods.mergePrice().call();case 5:return a=t.sent,t.next=8,e.kttContract.methods.decimals().call();case 8:if(r=t.sent,c=new _.a(a).dividedBy(Math.pow(10,r)).toFixed(2),!(Number(n)<Number(a))){t.next=13;break}return Object(E["a"])("KTT余额不足".concat(c)),t.abrupt("return");case 13:return e.btn.loading=!0,t.prev=14,t.next=17,e.swapContract.methods.mergeNft().send({from:e.address});case 17:Object(E["a"])("合成成功"),e.show=!0,e.btn.loading=!1,t.next=27;break;case 22:t.prev=22,t.t0=t["catch"](14),Object(E["a"])("合成失败"),e.btn.loading=!1;case 27:case"end":return t.stop()}}),t,null,[[14,22]])})));function n(){return t.apply(this,arguments)}return n}()});e.address&&e.initContract(),Object(a["T"])((function(){return e.address}),(function(t){t&&e.initContract()}));var n=Object(a["Q"])(e);return Object(h["a"])({},n)}},F=(n("c651"),n("6b0d")),R=n.n(F);const S=R()(T,[["render",O],["__scopeId","data-v-8ef34a16"]]);e["default"]=S},"8d5e":function(t,e,n){t.exports=n.p+"static/img/merge.47933a4b.png"},a9e3:function(t,e,n){"use strict";var a=n("83ab"),r=n("da84"),c=n("e330"),o=n("94ca"),i=n("6eeb"),s=n("1a2d"),u=n("7156"),b=n("3a9b"),l=n("d9b5"),d=n("c04e"),f=n("d039"),p=n("241c").f,g=n("06cf").f,w=n("9bf2").f,m=n("408a"),j=n("58a8").trim,O="Number",h=r[O],v=h.prototype,k=r.TypeError,N=c("".slice),x=c("".charCodeAt),C=function(t){var e=d(t,"number");return"bigint"==typeof e?e:E(e)},E=function(t){var e,n,a,r,c,o,i,s,u=d(t,"number");if(l(u))throw k("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=j(u),e=x(u,0),43===e||45===e){if(n=x(u,2),88===n||120===n)return NaN}else if(48===e){switch(x(u,1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+u}for(c=N(u,2),o=c.length,i=0;i<o;i++)if(s=x(c,i),s<48||s>r)return NaN;return parseInt(c,a)}return+u};if(o(O,!h(" 0o1")||!h("0b1")||h("+0x1"))){for(var A,I=function(t){var e=arguments.length<1?0:h(C(t)),n=this;return b(v,n)&&f((function(){m(n)}))?u(Object(e),n,I):e},y=a?p(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),_=0;y.length>_;_++)s(h,A=y[_])&&!s(I,A)&&w(I,A,g(h,A));I.prototype=v,v.constructor=I,i(r,O,I)}},ab9f:function(t,e,n){t.exports=n.p+"static/img/index_img.493d4559.png"},c2a5:function(t,e,n){t.exports=n.p+"static/img/_4.2e36bca2.gif"},c651:function(t,e,n){"use strict";n("5aea")}}]);
//# sourceMappingURL=chunk-bf187dd6.4665b1ec.js.map