{"version":3,"sources":["webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./src/views/stake/index.vue","webpack:///./src/views/stake/index.vue?ce6d","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./src/views/stake/index.vue?04ea","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js"],"names":["userAgent","firefox","match","module","exports","class","_createElementVNode","_createElementBlock","_createVNode","_component_HeadTop","title","isShowTop","isSubHeader","_hoisted_3","_component_van_cell","style","is-link","value","_ctx","text","onClick","_component_van_field","$event","center","clearable","label","placeholder","extra","_hoisted_4","_toDisplayString","Number","_createBlock","_component_van_button","color","type","loading","swaploading","size","loading-text","block","_component_van_popup","show","round","position","_component_van_picker","columns","onCancel","onConfirm","components","HeadTop","setup","store","useStore","data","reactive","address","computed","state","accounts","web3","provider","intro","get","config","rootAddress","swapContract","KttContract","KtmContract","kttAllowance","kttBalance","kttAmount","ktmAmount","showPicker","btn","swapKttAmount","swapAmount","pickerValue","initContract","eth","Contract","swapAbi","swapAddress","kttContract","tokenAbi","kttAddress","ktmContract","ktmAddress","initData","getBalance","getKttAllowance","getAllStakeType","methods","call","types","periodTime","arr","forEach","item","push","period","rate","id","sort","a","b","getOutKtmAmount","decimals","kttDecimals","balanceOf","BigNumber","dividedBy","toFixed","allowance","approveKtt","approve","MaxUint256","send","from","Toast","swapKtm","getUserInfo","introUserInfo","userUserInfo","AddressZero","amount","multipliedBy","stake","_","throttle","ktmDecimals","getKtmAmount","price","watch","val","refData","toRefs","__exports__","render","$","uncurryThis","aCallable","toObject","lengthOfArrayLike","toString","fails","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","test","un$Sort","FAILS_ON_UNDEFINED","undefined","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","index","result","String","fromCharCode","k","v","length","charAt","FORCED","getSortCompare","comparefn","x","y","target","proto","forced","array","this","itemsLength","items","arrayLength","webkit","arraySlice","floor","Math","mergeSort","middle","insertionSort","merge","element","j","i","left","right","llength","rlength","lindex","rindex","UA"],"mappings":"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","file":"static/js/chunk-62a88c09.6da5f863.js","sourcesContent":["var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","<template>\r\n  <div class=\"swap\">\r\n    <HeadTop title=\"质押\" :isShowTop=\"true\" :isSubHeader=\"false\"></HeadTop>\r\n    <div class=\"swap-item\">\r\n        <div class=\"title\">质押KTT</div>\r\n          <van-cell title=\"选择质押周期\" style=\"margin-bottom: 15px\" is-link :value=\"pickerValue.text\" @click=\"showPicker = true\"/>\r\n          <van-field\r\n    v-model=\"swapAmount\"\r\n    center\r\n    clearable\r\n    label=\"\"\r\n    @update:model-value=\"getOutKtmAmount\"\r\n    placeholder=\"请输入质押数量\"\r\n  >\r\n    <template #extra>\r\n      <span class=\"sympol\">KTT</span>\r\n    </template>\r\n  </van-field>\r\n  <div class=\"flex-between\">\r\n    <div class=\"price-desc\">获得: <span>{{ktmAmount}}</span> KTM</div>\r\n    <div class=\"price-desc\">余额: <span>{{kttBalance}}</span> KTT</div>\r\n  </div>\r\n  \r\n  <div class=\"button-box\">\r\n    <van-button color=\"linear-gradient(90deg, #5161F5 0%, #64C5FA 100%)\" type=\"primary\" :loading=\"btn.swaploading\" size=\"large\" loading-text=\"质押中...\" block v-if=\"Number(kttAllowance) > 0\" @click=\"swapKtm\">质押</van-button>\r\n     <van-button color=\"linear-gradient(90deg, #5161F5 0%, #64C5FA 100%)\" type=\"primary\" :loading=\"btn.swaploading\" v-else size=\"large\" loading-text=\"正在授权...\" @click=\"approveKtt\">授权KTT</van-button>\r\n  </div>\r\n    </div>\r\n    <van-popup v-model:show=\"showPicker\" round position=\"bottom\">\r\n  <van-picker\r\n    :columns=\"columns\"\r\n    @cancel=\"showPicker = false\"\r\n    @confirm=\"onConfirm\"\r\n  />\r\n</van-popup>\r\n  </div>\r\n</template>\r\n<script>\r\nimport HeadTop from '@/components/HeadTop'\r\nimport { reactive, toRefs, computed, watch } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { MaxUint256, AddressZero } from \"@ethersproject/constants\";\r\nimport BigNumber from 'bignumber.js';\r\nimport _ from 'lodash'\r\nimport swapAbi from \"@/utils/swapAbi\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport config from \"@/utils/config\";\r\nimport { Toast } from 'vant';\r\nimport { intro } from '@/storage'\r\n\r\nexport default {\r\n  components: {\r\n    HeadTop\r\n  },\r\n  setup () {\r\n    const store = useStore()\r\n    const data = reactive({\r\n      address: computed(() => store.state.accounts[0]),\r\n      web3: computed(() => store.state.provider),\r\n      intro: intro.get() || config.rootAddress,\r\n      swapContract: null,\r\n      KttContract: null,\r\n      KtmContract: null,\r\n      kttAllowance: '',\r\n      kttBalance: '0.00',\r\n      kttAmount: '0.00',\r\n      ktmAmount: '0.00',\r\n      showPicker: false,\r\n       btn: {\r\n        loading: false,\r\n        swaploading: false\r\n      },\r\n      swapKttAmount: '',\r\n      swapAmount: '',\r\n      pickerValue: null,\r\n      columns: [],\r\n      initContract: () => {\r\n        data.swapContract = new data.web3.eth.Contract(swapAbi, config.swapAddress)\r\n        data.kttContract = new data.web3.eth.Contract(tokenAbi, config.kttAddress)\r\n        data.ktmContract = new data.web3.eth.Contract(tokenAbi, config.ktmAddress)\r\n        data.initData()\r\n      },\r\n      initData: () => {\r\n        data.getBalance()\r\n        data.getKttAllowance()\r\n        data.getAllStakeType()\r\n      },\r\n      getAllStakeType: async () => {\r\n        let types = await data.swapContract.methods.getAllStakeType().call()\r\n        let periodTime = await data.swapContract.methods.periodTime().call()\r\n        let arr = []\r\n        console.log(types)\r\n        types.forEach(item => {\r\n          arr.push({\r\n            text: `${Number(item.period/periodTime)}天,${item.rate/10000}倍`,\r\n            value: item.id,\r\n            rate: item.rate\r\n          })\r\n        });\r\n        arr = arr.sort((a,b) => Number(a.rate) - Number(b.rate))\r\n        data.columns = arr\r\n        data.pickerValue = arr[0]\r\n      },\r\n      onConfirm: (value) => {\r\n        data.pickerValue = value\r\n        data.showPicker = false\r\n        data.getOutKtmAmount()\r\n      },\r\n      getBalance: async () => {\r\n        let kttDecimals = await data.kttContract.methods.decimals().call()\r\n        let kttBalance = await data.kttContract.methods.balanceOf(data.address).call()\r\n        data.kttBalance =  new BigNumber(kttBalance).dividedBy(10 ** kttDecimals).toFixed(2)\r\n      },\r\n       getKttAllowance: async () => {\r\n        let allowance = await data.kttContract.methods.allowance(data.address, config.swapAddress).call()\r\n        data.kttAllowance = allowance;\r\n      },\r\n      approveKtt: async () => {\r\n        data.btn.swaploading = true\r\n        try {\r\n          await data.kttContract.methods.approve(config.swapAddress, MaxUint256).send({from: data.address})\r\n          Toast('授权成功')\r\n          data.getKttAllowance()\r\n          data.btn.swaploading = false\r\n        } catch (error) {\r\n          Toast('授权失败')\r\n          data.btn.swaploading = false\r\n        }\r\n        \r\n      },\r\n      swapKtm: async () => {\r\n        if(!data.swapAmount) {\r\n          Toast('请先输入数量')\r\n          return\r\n        }\r\n        if(Number(data.swapAmount) > Number(data.kttBalance)) {\r\n          Toast('KTT余额不足')\r\n          return\r\n        }\r\n         let introUserInfo = await data.swapContract.methods.getUserInfo(data.intro).call()\r\n           let userUserInfo = await data.swapContract.methods.getUserInfo(data.address).call()\r\n        if(introUserInfo.intro == AddressZero && data.intro != config.rootAddress && userUserInfo.intro == AddressZero) {\r\n          Toast('推荐人无效')\r\n          return\r\n        }\r\n         data.btn.swaploading = true\r\n          let decimals = await data.kttContract.methods.decimals().call()\r\n          let amount = new BigNumber(data.swapAmount).multipliedBy(10 ** decimals).toFixed()\r\n        try {\r\n          await data.swapContract.methods.stake(data.pickerValue.value,amount, data.intro).send({from: data.address})\r\n          Toast('质押成功')\r\n           data.initData()\r\n          data.btn.swaploading = false\r\n        } catch (error) {\r\n          Toast('质押失败')\r\n          data.btn.swaploading = false\r\n        }\r\n      },\r\n      getOutKtmAmount: _.throttle(async function(){\r\n        if (!data.swapAmount || Number(data.swapAmount)  == 0) {\r\n          data.ktmAmount = '0.00'\r\n          return '0.00'\r\n        }\r\n        let kttDecimals = await data.kttContract.methods.decimals().call()\r\n         let ktmDecimals = await data.ktmContract.methods.decimals().call()\r\n         let amount = new BigNumber(data.swapAmount).multipliedBy(10 ** kttDecimals).toFixed()\r\n        let price = await data.swapContract.methods.getKtmAmount(amount).call()\r\n        data.ktmAmount = new BigNumber(price).multipliedBy(data.pickerValue.rate).dividedBy(10000).dividedBy(10**ktmDecimals).toFixed(2)\r\n      }, 1000)\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n    watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.swap{\r\n  padding: 16px;\r\n}\r\n.sympol{\r\n    font-size: 14px;\r\n}\r\n.swap-item{\r\n  background: #3F2E6F;\r\n  border-radius: 5px;\r\n  padding: 20px 14px;\r\n  margin-bottom: 15px;\r\n  .title{\r\n    text-align: center;\r\n    color: #fff;\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    margin-bottom: 20px;\r\n  }\r\n  .price-desc{\r\n    font-size: 12px;\r\n    font-weight: 600;\r\n    color: #E4D7FF;\r\n    margin: 15px 8px;\r\n    span{\r\n      color: #FFD511;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=21b953f2&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=21b953f2&lang=less&scoped=true\"\n\nimport exportComponent from \"F:\\\\activeSelf\\\\ketai_vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-21b953f2\"]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=21b953f2&lang=less&scoped=true\"","var arraySlice = require('../internals/array-slice-simple');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n"],"sourceRoot":""}