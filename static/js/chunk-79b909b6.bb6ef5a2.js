(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79b909b6"],{"0308":function(e,t,n){},"52f9":function(e,t,n){"use strict";n.r(t);var a=n("7a23"),c=function(e){return Object(a["H"])("data-v-06fe9b5a"),e=e(),Object(a["F"])(),e},i={class:"swap-box invest-box"},r={class:"list-box"},s={class:"top flex-middle"},d={class:"top-item flex-item"},o={class:"num"},u=c((function(){return Object(a["k"])("div",{class:"desc"},"质押KTT",-1)})),l=c((function(){return Object(a["k"])("div",{class:"line"},null,-1)})),b={class:"top-item flex-item"},j={class:"num yellow"},m=c((function(){return Object(a["k"])("div",{class:"desc"},"KTM总收益",-1)})),O={class:"bottom"},f={key:0,class:"status"},k={key:1,class:"status"},p={key:2,class:"status red"},v={class:"row flex-middle"},w=c((function(){return Object(a["k"])("div",{class:"name"},"时长",-1)})),h={class:"value"},y={class:"row flex-middle"},x=c((function(){return Object(a["k"])("div",{class:"name"},"质押时间",-1)})),T={class:"value"},g={class:"row flex-middle"},C=c((function(){return Object(a["k"])("div",{class:"name"},"质押到期时间",-1)})),R={class:"value"},K={key:0,class:"btn-box flex-between"},L=c((function(){return Object(a["k"])("span",null,null,-1)})),M=Object(a["m"])("领取");function E(e,t,n,c,E,H){var B=Object(a["L"])("HeadTop"),N=Object(a["L"])("van-button"),P=Object(a["L"])("van-list");return Object(a["E"])(),Object(a["j"])("div",i,[Object(a["n"])(B,{title:"记录",isShowTop:!0,isSubHeader:!1}),Object(a["n"])(P,{loading:e.loading,"onUpdate:loading":t[0]||(t[0]=function(t){return e.loading=t}),"immediate-check":!1,error:e.error,"onUpdate:error":t[1]||(t[1]=function(t){return e.error=t}),"error-text":"请求失败，点击重新加载",finished:e.finished,"finished-text":"没有更多了",onLoad:e.onLoad},{default:Object(a["V"])((function(){return[Object(a["k"])("div",r,[(Object(a["E"])(!0),Object(a["j"])(a["a"],null,Object(a["K"])(e.list,(function(t,n){return Object(a["E"])(),Object(a["j"])("div",{class:"item",key:n},[Object(a["k"])("div",s,[Object(a["k"])("div",d,[Object(a["k"])("div",o,Object(a["P"])(t.stakeKttAmount),1),u]),l,Object(a["k"])("div",b,[Object(a["k"])("div",j,Object(a["P"])(t.totalRewardKtm),1),m])]),Object(a["k"])("div",O,[t.isValid?t.isCanTake?(Object(a["E"])(),Object(a["j"])("div",k,"可领取")):(Object(a["E"])(),Object(a["j"])("div",p,Object(a["P"])(e.$t("未到期")),1)):(Object(a["E"])(),Object(a["j"])("div",f,"已领取")),Object(a["k"])("div",v,[w,Object(a["k"])("div",h,Object(a["P"])(t.lockTime)+"天",1)]),Object(a["k"])("div",y,[x,Object(a["k"])("div",T,Object(a["P"])(t.stakeTime),1)]),Object(a["k"])("div",g,[C,Object(a["k"])("div",R,Object(a["P"])(t.endTime),1)])]),t.isCanTake&&t.isValid?(Object(a["E"])(),Object(a["j"])("div",K,[L,Object(a["n"])(N,{type:"primary",class:"btn-green",style:{width:"120px"},block:"",onClick:function(n){return e.withdrawRewardStakeRecord(t.id)}},{default:Object(a["V"])((function(){return[M]})),_:2},1032,["onClick"])])):Object(a["i"])("",!0)])})),128))])]})),_:1},8,["loading","error","finished","onLoad"])])}var H=n("5530"),B=n("1da1"),N=(n("96cf"),n("d3b7"),n("159b"),n("a9e3"),n("b680"),n("1a2e")),P=n("5502"),V=n("a1be"),F=n("626a"),S=n("01ea"),A=n("901e"),_=n.n(A),U=n("b9b9"),D=n.n(U),I={components:{HeadTop:N["a"]},setup:function(){var e=Object(P["b"])(),t=Object(a["I"])({address:Object(a["f"])((function(){return e.state.accounts[0]})),web3:Object(a["f"])((function(){return e.state.provider})),swapContract:null,page:1,limit:5,loading:!1,error:!1,finished:!1,list:[],initContract:function(){t.swapContract=new t.web3.eth.Contract(V,S["a"].swapAddress),t.initData()},initData:function(){t.list=[],t.page=1,t.getList()},onLoad:function(){t.page++,t.getList()},getList:function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(){var n,a,c,i,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.swapContract.methods.getUserRewardRecords(t.address,1,5).call({from:t.address});case 2:return n=e.sent,e.next=5,t.swapContract.methods.periodTime().call();case 5:return a=e.sent,e.next=8,t.swapContract.methods.getBlockTimestamp().call();case 8:c=e.sent,i=n.records,r=[],i.forEach((function(e){Number(e.id)>0&&r.push({stakeKttAmount:new _.a(e.stakeKttAmount).dividedBy(Math.pow(10,18)).toFixed(2),totalRewardKtm:new _.a(e.totalRewardKtm).dividedBy(Math.pow(10,18)).toFixed(2),dayBackKtm:new _.a(e.dayBackKtm).dividedBy(Math.pow(10,18)).toFixed(2),id:e.id,isValid:e.isValid,lockTime:new _.a(e.lockTime).dividedBy(a).toFixed(1),stakeTime:D()(1e3*e.stakeTime,"yyyy-mm-dd HH:MM:ss"),endTime:D()(1e3*(Number(e.stakeTime)+Number(e.lockTime)),"yyyy-mm-dd HH:MM:ss"),isCanTake:Number(c)>=Number(e.stakeTime)+Number(e.lockTime)})})),1===t.page?t.list=r:(s=t.list).push.apply(s,r),t.loading=!1,t.finished=!(Math.ceil(n.total/t.limit)>t.page);case 15:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),withdrawRewardStakeRecord:function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.swapContract.methods.withdrawRewardStakeRecord(n).send({from:t.address});case 3:Object(F["a"])("领取成功"),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),Object(F["a"])("领取失败");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));function n(t){return e.apply(this,arguments)}return n}()});t.address&&t.initContract(),Object(a["T"])((function(){return t.address}),(function(e){e&&t.initContract()}));var n=Object(a["Q"])(t);return Object(H["a"])({},n)}},J=(n("53d4"),n("6b0d")),Q=n.n(J);const $=Q()(I,[["render",E],["__scopeId","data-v-06fe9b5a"]]);t["default"]=$},"53d4":function(e,t,n){"use strict";n("0308")}}]);
//# sourceMappingURL=chunk-79b909b6.bb6ef5a2.js.map